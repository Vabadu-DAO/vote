var Ee=Object.defineProperty;var Ae=(t,e,n)=>e in t?Ee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var j=(t,e,n)=>(Ae(t,typeof e!="symbol"?e+"":e,n),n);import{aZ as _t,b as o,s as l,b2 as H,j as u,I as f,aX as Te,aY as Re,bj as ke,bk as Ve,a$ as Ut,bl as Pe,b3 as Ne,b4 as Le,bm as Ie,b6 as De,b7 as Oe,bn as Fe,ad as $e,u as S,c as x,d as vt,P as O,L as _,a7 as U,bo as Pt,ag as J,C as y,bp as He,bq as Me,br as K,f as A,T as w,a6 as z,bs as Be,B as Z,i as We,aa as je,bt as ze,bu as _e,bv as Ue,_ as k,m as X,ak as Nt,bw as Ke,bx as Ye,by as Q,ah as Kt,a9 as F,ax as qe,bz as Ge,bA as Ze,bB as Qe,a3 as bt,aA as Je,a4 as Xe,a5 as Yt,bC as tn,ba as en,U as wt,bD as nn,bE as on,bF as sn,o as tt,aC as qt,bG as rn,bH as an,bI as cn,bJ as ln,az as dn,bK as un,t as et,bL as P,Z as pn,bM as hn,ar as Ct,bN as pt,bO as xt,bP as fn,bQ as mn,F as gn,p as nt,bb as yn,g as Sn,bR as vn,bc as bn,aL as wn,aQ as Gt,a2 as Cn,J as xn,a as Et,h as Zt,D as En,bS as An,bT as Tn,E as Rn,l as kn,bi as Vn,aJ as Pn,bU as Nn}from"./index-7a5adea9.js";import{c as Ln,a as ht,C as In}from"./index.esm-87920604.js";import{L as Dn}from"./List-e4234f64.js";import{S as On}from"./Status-df1b552c.js";import{P as Fn}from"./Page-e939ccea.js";const $n=_t(o("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),Hn=_t(o("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),Mn=l("span")({position:"relative",display:"flex"}),Bn=l($n)({transform:"scale(1)"}),Wn=l(Hn)(({theme:t,ownerState:e})=>H({left:0,position:"absolute",transform:"scale(0)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.shortest})},e.checked&&{transform:"scale(1)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.shortest})}));function Qt(t){const{checked:e=!1,classes:n={},fontSize:s}=t,i=H({},t,{checked:e});return u(Mn,{className:n.root,ownerState:i,children:[o(Bn,{fontSize:s,className:n.background,ownerState:i}),o(Wn,{fontSize:s,className:n.dot,ownerState:i})]})}const jn=f.createContext(void 0),zn=jn;function _n(){return f.useContext(zn)}function Un(t){return Re("MuiRadio",t)}const Kn=Te("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary"]),Lt=Kn,Yn=["checked","checkedIcon","color","icon","name","onChange","size","className"],qn=t=>{const{classes:e,color:n}=t,s={root:["root",`color${Ut(n)}`]};return H({},e,Oe(s,Un,e))},Gn=l(ke,{shouldForwardProp:t=>Ve(t)||t==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`color${Ut(n.color)}`]]}})(({theme:t,ownerState:e})=>H({color:(t.vars||t).palette.text.secondary},!e.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${e.color==="default"?t.vars.palette.action.activeChannel:t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Pe(e.color==="default"?t.palette.action.active:t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.color!=="default"&&{[`&.${Lt.checked}`]:{color:(t.vars||t).palette[e.color].main}},{[`&.${Lt.disabled}`]:{color:(t.vars||t).palette.action.disabled}}));function Zn(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}const It=o(Qt,{checked:!0}),Dt=o(Qt,{}),Qn=f.forwardRef(function(e,n){var s,i;const r=Ne({props:e,name:"MuiRadio"}),{checked:c,checkedIcon:a=It,color:p="primary",icon:m=Dt,name:d,onChange:h,size:g="medium",className:v}=r,T=Le(r,Yn),b=H({},r,{color:p,size:g}),E=qn(b),V=_n();let I=c;const L=Ie(h,V&&V.onChange);let M=d;return V&&(typeof I>"u"&&(I=Zn(V.value,r.value)),typeof M>"u"&&(M=V.name)),o(Gn,H({type:"radio",icon:f.cloneElement(m,{fontSize:(s=Dt.props.fontSize)!=null?s:g}),checkedIcon:f.cloneElement(a,{fontSize:(i=It.props.fontSize)!=null?i:g}),ownerState:b,classes:E,name:M,checked:I,onChange:L,ref:n,className:De(E.root,v)},T))}),Ot=Qn;function Jt({value:t,decimalScale:e=2,prefix:n,className:s="",suffix:i}){return o(Fe,{type:"text",valueIsNumericString:!0,value:t,allowLeadingZeros:!0,thousandSeparator:",",className:`number-display ${s}`,displayType:"text",decimalScale:e,prefix:n,suffix:i})}const C=()=>{const{t}=$e("proposalPage");return{castVote:t("castVote"),timeLeftToVote:t("timeLeftToVote"),resultsVerified:t("resultsVerified"),verifyingResults:t("verifyingResults"),failedToVerifyResults:t("failedToVerifyResults"),address:t("address"),vote:t("vote"),votingPower:t("votingPower"),date:t("date"),voteStartsIn:t("voteStartsIn"),results:t("results"),recentVotes:t("recentVotes"),information:t("information"),startDate:t("startDate"),endDate:t("endDate"),snapshot:t("snapshot"),contract:t("contract"),votingStrategy:t("votingStrategy"),votes:t("votes"),showMore:t("showMore"),verifyInfo:t("verifyInfo"),downloadCsv:t("downloadCsv"),showLess:t("showLess"),yourVotingPower:t("yourVotingPower"),choice:t("choice"),notEnoughVotingPower:e=>t("notEnoughVotingPower",{value:e}),confirm:t("confirm"),noVotes:t("noVotes"),you:t("you"),httpsv2Endpoint:t("httpsv2Endpoint"),httpsv2ApiKey:t("httpsv2ApiKey"),httpv4Endpoint:t("httpv4Endpoint"),tonAccessEnpoint:t("tonAccessEnpoint"),customEndpoint:t("customEndpoint"),verify:t("verify"),rpcSelectTitle:t("rpcSelectTitle"),verifyResults:t("verifyResults")}},Ft=t=>t?J.unix(t).valueOf():0;function Jn(){const{proposalAddress:t}=S(),{data:e}=x(t),{proposalStatus:n}=vt(t),s=C(),i=e==null?void 0:e.metadata,r=f.useMemo(()=>n?n===O.NOT_STARTED?s.voteStartsIn:s.timeLeftToVote:"",[n]);return i?o(U,{title:r,children:n===O.NOT_STARTED?o(Pt,{date:Ft(i==null?void 0:i.proposalStartTime)}):n===O.ACTIVE?o(Pt,{date:Ft(i==null?void 0:i.proposalEndTime)}):null}):o(_,{})}const ft=(t,e="MMM DD, YYYY HH:mm")=>`${J.unix(t).utc().format(e)} UTC`,Xn=()=>{const{proposalAddress:t}=S(),{isLoading:e,data:n}=x(t),s=C(),i=n==null?void 0:n.metadata,r=He(t),c=Me(t),a=c.jetton,p=c.nft,m=K(t);return e?o(_,{}):o(no,{title:s.information,children:i&&u(A,{gap:12,children:[o(D,{label:s.startDate,children:o(w,{children:ft(Number(i.proposalStartTime))})}),o(D,{label:s.endDate,children:o(w,{children:ft(Number(i.proposalEndTime))})}),o(D,{label:s.snapshot,children:o(w,{children:ft(Number(i.proposalSnapshotTime))})}),o(D,{label:s.contract,children:o(z,{address:t})}),o(D,{label:s.votingStrategy,children:m?o(to,{href:Be,target:"_blank",children:o(Z,{text:r})}):o(Z,{text:r})}),a&&o(D,{label:"Jetton Address",children:o(z,{address:a})}),p&&o(D,{label:"NFT collection",children:o(z,{address:p})})]})})},to=l("a")(({theme:t})=>({textDecoration:"unset","&:hover":{textDecoration:"underline",textDecorationColor:t.palette.text.primary}})),D=({label:t,children:e})=>u(eo,{justifyContent:"space-between",gap:50,children:[o(w,{className:"row-label",children:t}),o("div",{className:"row-children",children:e})]}),eo=l(y)({width:"100%",".row-label":{fontSize:14,fontWeight:700,whiteSpace:"nowrap"},".row-children":{"*":{fontSize:14,fontWeight:400}}}),no=l(U)({width:"100%"}),Xt=We(je(t=>({endpoints:void 0,setEndpoints:e=>{t({endpoints:e})}}),{name:"ton_vote_endpoints_verify_store"})),$t=t=>{const e=n=>k.isNull(n)||k.isNaN(n)?0:k.isString(n)?Number(n):n;if(t)return k.forEach(t,(n,s)=>{t[s]=e(n)}),t},oo=()=>{const{proposalAddress:t}=S(),{data:e}=x(t),{setEndpoints:n,endpoints:s}=Xt(),i=C(),r=ze(),c=_e();return Ue(async a=>{n(a);const m=(async()=>{const d=await Nt.getClientV2(s==null?void 0:s.clientV2Endpoint,s==null?void 0:s.apiKey),h=await Nt.getClientV4(s==null?void 0:s.clientV4Endpoint),v=r.getValues(t).maxLtAfterVote||(e==null?void 0:e.maxLt)||"",T=await Ke.getProposal({clientV2:d,clientV4:h,proposalAddress:t,metadata:e==null?void 0:e.metadata,maxLt:v}),b=$t(e==null?void 0:e.proposalResult),E=$t(T==null?void 0:T.proposalResult);Ye({currentResults:b,compareToResults:E});const V=k.isEqual(b,E);if(!V)throw new Error("Not equal");return V})();return c({promise:m,success:i.resultsVerified,loading:i.verifyingResults,error:i.failedToVerifyResults}),k.isEmpty(e==null?void 0:e.proposalResult)?!0:m},{onError:a=>console.log(a.message)})},te=(t,e)=>{const n=X();return f.useMemo(()=>k.find(t,s=>s.address===n),[e,n])},so=t=>{let e=[],n=[];return t?(e=["address","vote","date"],n=["address","vote"]):(e=["address","vote","votingPower","date"],n=["address","vote","votingPower"]),{titles:e,keys:n}},io=()=>{const t=C(),{proposalAddress:e}=S(),{data:n,dataUpdatedAt:s}=x(e),i=K(e);return f.useMemo(()=>{const r=so(i),c=k.map(n==null?void 0:n.votes,a=>[...r.keys.map(m=>a[m]),J.unix(a.timestamp).format("DD/MM/YY HH:mm:ss")]);return c.unshift(r.titles.map(a=>t[a])),c},[s])};function ro(t){const e=parseFloat(t);return!isNaN(e)&&isFinite(e)}function Ht(t){return typeof t=="string"&&t[t.length-1]==="%"&&ro(t.substring(0,t.length-1))}function mt(t,e){e===0&&(t!=null&&t.style)&&(t.style.display="none")}function ao(t,e){e===0&&(t!=null&&t.style)&&(t.style.display="")}const co={animating:"rah-animating",animatingUp:"rah-animating--up",animatingDown:"rah-animating--down",animatingToHeightZero:"rah-animating--to-height-zero",animatingToHeightAuto:"rah-animating--to-height-auto",animatingToHeightSpecific:"rah-animating--to-height-specific",static:"rah-static",staticHeightZero:"rah-static--height-zero",staticHeightAuto:"rah-static--height-auto",staticHeightSpecific:"rah-static--height-specific"};function Mt(t,e){return[t.static,e===0&&t.staticHeightZero,e>0&&t.staticHeightSpecific,e==="auto"&&t.staticHeightAuto].filter(n=>n).join(" ")}const lo=["animateOpacity","animationStateClasses","applyInlineTransitions","children","className","contentClassName","delay","duration","easing","height","onHeightAnimationEnd","onHeightAnimationStart","style"],ee=t=>{const{animateOpacity:e=!1,animationStateClasses:n={},applyInlineTransitions:s=!0,children:i,className:r="",contentClassName:c,delay:a=0,duration:p=500,easing:m="ease",height:d,onHeightAnimationEnd:h,onHeightAnimationStart:g,style:v}=t,T=Object.assign({},t);lo.forEach(q=>{delete T[q]});const b=f.useRef(d),E=f.useRef(null),V=f.useRef(),I=f.useRef(),L=f.useRef(Object.assign(Object.assign({},co),n)),M=typeof window<"u",Tt=f.useRef(M&&window.matchMedia?window.matchMedia("(prefers-reduced-motion)").matches:!1),ot=Tt.current?0:a,st=Tt.current?0:p;let B=d,it="visible";typeof B=="number"?(B=d<0?0:d,it="hidden"):Ht(B)&&(B=d==="0%"?0:d,it="hidden");const[rt,at]=f.useState(B),[Se,ct]=f.useState(it),[ve,Y]=f.useState(!1),[be,lt]=f.useState(Mt(L.current,d));f.useEffect(()=>{mt(E.current,rt)},[]),f.useEffect(()=>{if(d!==b.current&&E.current){ao(E.current,b.current),E.current.style.overflow="hidden";const q=E.current.offsetHeight;E.current.style.overflow="";const Rt=st+ot;let N,R,dt="hidden",kt;const ut=b.current==="auto";typeof d=="number"?(N=d<0?0:d,R=N):Ht(d)?(N=d==="0%"?0:d,R=N):(N=q,R="auto",dt=void 0),ut&&(R=N,N=q);const Ce=[L.current.animating,(b.current==="auto"||d<b.current)&&L.current.animatingUp,(d==="auto"||d>b.current)&&L.current.animatingDown,R===0&&L.current.animatingToHeightZero,R==="auto"&&L.current.animatingToHeightAuto,R>0&&L.current.animatingToHeightSpecific].filter(xe=>xe).join(" "),Vt=Mt(L.current,R);at(N),ct("hidden"),Y(!ut),lt(Ce),clearTimeout(I.current),clearTimeout(V.current),ut?(kt=!0,I.current=setTimeout(()=>{at(R),ct(dt),Y(kt),g==null||g(R)},50),V.current=setTimeout(()=>{Y(!1),lt(Vt),mt(E.current,R),h==null||h(R)},Rt)):(g==null||g(N),I.current=setTimeout(()=>{at(R),ct(dt),Y(!1),lt(Vt),d!=="auto"&&mt(E.current,N),h==null||h(N)},Rt))}return b.current=d,()=>{clearTimeout(I.current),clearTimeout(V.current)}},[d]);const $=Object.assign(Object.assign({},v),{height:rt,overflow:Se||(v==null?void 0:v.overflow)});ve&&s&&($.transition=`height ${st}ms ${m} ${ot}ms`,v!=null&&v.transition&&($.transition=`${v.transition}, ${$.transition}`),$.WebkitTransition=$.transition);const W={};e&&(W.transition=`opacity ${st}ms ${m} ${ot}ms`,W.WebkitTransition=W.transition,rt===0&&(W.opacity=0));const we=typeof T["aria-hidden"]<"u"?T["aria-hidden"]:d===0;return Q.createElement("div",Object.assign({},T,{"aria-hidden":we,className:`${be} ${r}`,style:$}),Q.createElement("div",{className:c,style:W,ref:E},i))},uo=()=>{const t=Xe(),e=C();return Ln().shape({clientV2Endpoint:ht().required(t.isRequired(e.httpsv2Endpoint)),apiKey:ht(),clientV4Endpoint:ht().required(t.isRequired(e.httpv4Endpoint))})},po=()=>{const t=C();return[{title:"",inputs:[{label:t.httpsv2Endpoint,type:"text",name:"clientV2Endpoint"},{label:t.httpsv2ApiKey,type:"text",name:"apiKey"},{label:t.httpv4Endpoint,type:"text",name:"clientV4Endpoint"}]}]};function ho({open:t,onClose:e,onSubmit:n}){const{endpoints:s}=Xt(),[i,r]=f.useState(!1),c=uo(),a=C(),p=po(),m=qe({initialValues:{apiKey:(s==null?void 0:s.apiKey)||Ge,clientV2Endpoint:(s==null?void 0:s.clientV2Endpoint)||Ze,clientV4Endpoint:(s==null?void 0:s.clientV4Endpoint)||Qe},validationSchema:c,validateOnChange:!1,validateOnBlur:!0,onSubmit:async h=>{n({clientV2Endpoint:h.clientV2Endpoint,clientV4Endpoint:h.clientV4Endpoint,apiKey:h.apiKey}),e()}}),d=()=>{i?m.submitForm():(n({}),e())};return f.useEffect(()=>{r(!!(s!=null&&s.clientV2Endpoint)&&!!s.clientV4Endpoint)},[s==null?void 0:s.clientV2Endpoint,s==null?void 0:s.clientV4Endpoint,t]),o(fo,{open:t,onClose:e,title:a.rpcSelectTitle,children:u(A,{gap:0,children:[u(A,{gap:5,children:[u(Bt,{children:[o(Ot,{checked:!i,onChange:()=>r(!1)}),o(bt,{children:a.tonAccessEnpoint})]}),u(Bt,{children:[o(Ot,{checked:i,onChange:()=>r(!0)}),o(w,{children:a.customEndpoint})]})]}),o(ee,{style:{width:"100%"},height:i?"auto":0,duration:200,children:o(Je,{form:p,formik:m})}),o(mo,{onClick:d,children:a.verify})]})})}const Bt=l(y)({a:{textDecoration:"unset",fontWeight:500,fontSize:17},justifyContent:"flex-start",p:{fontWeight:500,fontSize:17}}),fo=l(Kt)({maxWidth:600,padding:0,".formik-form":{border:"unset!important",boxShadow:"unset",".title-container-children":{padding:20}}}),mo=l(F)({width:"100%",maxWidth:200,marginTop:30,marginBottom:10}),Wt=5,go=()=>{const{proposalAddress:t}=S(),{isLoading:e}=x(t),[n,s]=f.useState(!1),i=C(),r=tn(t),c=en(t);return e?o(_,{}):u(Eo,{title:i.results,children:[u(A,{gap:15,children:[c.map((a,p)=>p>=Wt&&!n?null:o(vo,{name:a.choice,percent:a.percent,amount:a.amount,votes:a.votesCount},a.choice)),k.size(c)>Wt&&o(yo,{toggle:s,value:n})]}),!r&&o(Ao,{})]})},yo=({toggle:t,value:e})=>{const n=C();return o(So,{onClick:()=>t(!e),children:e?n.showLess:n.showMore})},So=l(F)({padding:"6px 10px",height:"unset",marginLeft:"auto","*":{fontSize:12}}),vo=({name:t,percent:e=0,amount:n="",votes:s})=>{const i=C();return u(xo,{children:[u(y,{justifyContent:"space-between",width:"100%",children:[u(y,{style:{width:"fit-content"},children:[o("div",{children:o(bo,{text:t})}),o(wo,{label:`${wt(s,2)} ${i.votes}`})]}),u(Co,{justifyContent:"flex-end",children:[n&&o(w,{fontSize:13,style:{whiteSpace:"nowrap"},children:n}),u(w,{className:"percent",children:[e,"%"]})]})]}),o(nn,{progress:e})]})},bo=l(Z)({textTransform:"capitalize"}),wo=l(Yt)({fontSize:11,height:25,".MuiChip-label":{paddingLeft:10,paddingRight:10}}),Co=l(y)({flex:1}),xo=l(A)({gap:5,fontWeight:600,p:{fontWeight:"inherit"},".percent":{fontSize:14}}),Eo=l(U)({width:"100%"});function Ao(){const{mutate:t,isLoading:e,error:n,isSuccess:s,reset:i}=oo(),r=C(),{proposalAddress:c}=S();f.useEffect(()=>{(s||n)&&setTimeout(()=>{i()},5e3)},[s,i,n]);const[a,p]=f.useState(!1),m=()=>{tt.isMockProposal(c)?qt("This is a mock proposal. You can not verify it."):p(!0)};return u(To,{children:[o(Ro,{children:r.verifyInfo}),o(ho,{onSubmit:t,open:a,onClose:()=>p(!1)}),s?o(gt,{children:u(y,{children:[o(w,{children:"Verified"}),o(on,{className:"icon"})]})}):n?o(gt,{children:u(y,{children:[o(w,{children:"Not Verified"}),o(sn,{className:"icon"})]})}):o(gt,{onClick:m,isLoading:e,children:o(w,{children:r.verifyResults})})]})}const To=l(A)(({theme:t})=>({marginTop:30,justifyContent:"center",width:"100%",gap:15})),Ro=l(bt)({fontWeight:500,a:{textDecoration:"unset"}}),gt=l(F)({height:40,minWidth:180,"*":{fontSize:15},".icon":{width:18,height:18,position:"relative",top:-1},".loader":{maxWidth:20,maxHeight:20}});function ko({open:t,onClose:e,vote:n,onSubmit:s}){var h,g,v;const i=C(),{proposalAddress:r}=S(),{data:c}=x(r),{data:a,isLoading:p,refetch:m}=an(c,r);f.useEffect(()=>{t&&m()},[t]);const d=a?!!(a&&Number(a)===0):!0;return o(Po,{title:i.castVote,open:t,onClose:e,children:u(Io,{gap:30,children:[u(A,{children:[o(Lo,{label:i.choice,value:n}),((h=c==null?void 0:c.metadata)==null?void 0:h.mcSnapshotBlock)&&o(St,{label:i.snapshot,value:o(Jt,{value:(g=c==null?void 0:c.metadata)==null?void 0:g.mcSnapshotBlock})}),o(St,{isLoading:p,label:i.yourVotingPower,value:a})]}),d&&o(cn,{message:i.notEnoughVotingPower(((v=c==null?void 0:c.metadata)==null?void 0:v.mcSnapshotBlock.toLocaleString())||"")}),u(Vo,{children:[o(F,{variant:"transparent",onClick:e,children:"Cancel"}),o(F,{disabled:d||p,onClick:()=>{s(),e()},children:i.confirm})]})]})})}const Vo=l(y)({button:{width:"50%"}}),Po=l(Kt)({maxWidth:400,padding:0}),St=({label:t,value:e,isLoading:n,className:s=""})=>u(No,{className:s,justifyContent:"space-between",children:[o(w,{className:"label",children:t}),n?o(rn,{style:{width:20,height:20}}):o(w,{className:"value",children:e})]}),No=l(y)({".label":{fontWeight:700},".value":{fontWeight:600}}),Lo=l(St)({".value":{textTransform:"capitalize"}}),Io=l(A)({});function Do(){var T;const[t,e]=f.useState(),{mutate:n,isLoading:s}=ln(),[i,r]=f.useState(!1),c=C(),{proposalAddress:a}=S(),{data:p,dataUpdatedAt:m}=x(a),d=(T=p==null?void 0:p.metadata)==null?void 0:T.votingSystem.choices,h=te(p==null?void 0:p.votes,m),g=h==null?void 0:h.vote;f.useEffect(()=>{t||e(h==null?void 0:h.vote)},[h==null?void 0:h.vote]);const v=()=>{tt.isMockProposal(a)?qt("You can't vote on mock proposals"):r(!0)};return u(Mo,{title:c.castVote,children:[o(A,{children:d==null?void 0:d.map(b=>u(Ho,{selected:b===t,onClick:()=>e(b),children:[o(dn,{in:b===t,children:o(y,{className:"icon",children:o(un,{style:{width:20,height:20}})})}),o(w,{children:b})]},b))}),o(et,{text:g===t?`You already voted ${t}`:"",children:o(Oo,{isLoading:s,disabled:!t||s||g===t,onSubmit:v})}),o(ko,{open:i,vote:t,onClose:()=>r(!1),onSubmit:()=>{t&&n(t)}})]})}const Oo=({onSubmit:t,isLoading:e,disabled:n})=>X()?o(Fo,{onClick:t,isLoading:e,disabled:n,children:"Vote"}):o($o,{}),Fo=l(F)({marginTop:20,width:"100%"}),$o=l(In)({marginTop:20,width:"100%"}),Ho=l(y)(({theme:t,selected:e})=>({transition:"0.2s all",width:"100%",borderRadius:30,height:40,cursor:"pointer",position:"relative",".icon":{position:"absolute",left:20,top:"50%",transform:"translate(0, -50%)",width:"fit-content"},border:e?`1.5px solid ${t.palette.primary.main}`:"1.5px solid rgba(114, 138, 150, 0.24)",color:t.palette.mode==="light"?t.palette.primary.main:"white",p:{color:"inherit",fontWeight:600,fontSize:16}})),Mo=l(U)({}),Bo=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),ne=t=>Array.isArray(t)&&t.every(e=>typeof e=="object"&&!(e instanceof Array)),Wo=t=>Array.isArray(t)&&t.every(e=>Array.isArray(e)),jo=t=>Array.from(t.map(e=>Object.keys(e)).reduce((e,n)=>new Set([...e,...n]),[])),zo=(t,e)=>{e=e||jo(t);let n=e,s=e;ne(e)&&(n=e.map(r=>r.label),s=e.map(r=>r.key));const i=t.map(r=>s.map(c=>_o(c,r)));return[n,...i]},_o=(t,e)=>{const n=t.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(s,i,r,c){const a=s[i];if(a==null)c.splice(1);else return a},e);return n===void 0?t in e?e[t]:"":n},Uo=t=>typeof t>"u"||t===null?"":t,oe=(t,e=",",n='"')=>t.filter(s=>s).map(s=>s.map(i=>Uo(i)).map(i=>`${n}${i}${n}`).join(e)).join(`
`),Ko=(t,e,n,s)=>oe(e?[e,...t]:t,n,s),Yo=(t,e,n,s)=>oe(zo(t,e),n,s),qo=(t,e,n,s)=>e?`${e.join(n)}
${t}`:t.replace(/"/g,'""'),se=(t,e,n,s)=>{if(ne(t))return Yo(t,e,n,s);if(Wo(t))return Ko(t,e,n,s);if(typeof t=="string")return qo(t,e,n);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')},ie=(t,e,n,s,i)=>{const r=se(t,n,s,i),c=Bo()?"application/csv":"text/csv",a=new Blob([e?"\uFEFF":"",r],{type:c}),p=`data:${c};charset=utf-8,${e?"\uFEFF":""}${r}`,m=window.URL||window.webkitURL;return typeof m.createObjectURL>"u"?p:m.createObjectURL(a)},re={data:P.oneOfType([P.string,P.array,P.func]).isRequired,headers:P.array,target:P.string,separator:P.string,filename:P.string,uFEFF:P.bool,onClick:P.func,asyncOnClick:P.bool,enclosingCharacter:P.string},ae={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},Go={target:"_blank"};class jt extends Q.Component{constructor(e){super(e),this.state={}}buildURI(){return ie(...arguments)}componentDidMount(){const{data:e,headers:n,separator:s,enclosingCharacter:i,uFEFF:r,target:c,specs:a,replace:p}=this.props;this.state.page=window.open(this.buildURI(e,r,n,s,i),c,a,p)}getWindow(){return this.state.page}render(){return null}}j(jt,"defaultProps",Object.assign(ae,Go)),j(jt,"propTypes",re);var G;let Zo=(G=class extends Q.Component{constructor(e){super(e),this.buildURI=this.buildURI.bind(this)}buildURI(){return ie(...arguments)}handleLegacy(e,n=!1){if(window.navigator.msSaveOrOpenBlob){e.preventDefault();const{data:s,headers:i,separator:r,filename:c,enclosingCharacter:a,uFEFF:p}=this.props,m=n&&typeof s=="function"?s():s;let d=new Blob([p?"\uFEFF":"",se(m,i,r,a)]);return window.navigator.msSaveBlob(d,c),!1}}handleAsyncClick(e){const n=s=>{if(s===!1){e.preventDefault();return}this.handleLegacy(e,!0)};this.props.onClick(e,n)}handleSyncClick(e){if(this.props.onClick(e)===!1){e.preventDefault();return}this.handleLegacy(e)}handleClick(){return e=>{if(typeof this.props.onClick=="function")return this.props.asyncOnClick?this.handleAsyncClick(e):this.handleSyncClick(e);this.handleLegacy(e)}}render(){const{data:e,headers:n,separator:s,filename:i,uFEFF:r,children:c,onClick:a,asyncOnClick:p,enclosingCharacter:m,...d}=this.props,g=typeof window>"u"?"":this.buildURI(e,r,n,s,m);return o("a",{download:i,...d,ref:v=>this.link=v,target:"_self",href:g,onClick:this.handleClick(),children:c})}},j(G,"defaultProps",ae),j(G,"propTypes",re),G);const Qo=Zo,Jo=()=>{var m;const{proposalAddress:t}=S(),{data:e}=x(t),n=((m=e==null?void 0:e.proposalResult)==null?void 0:m.totalWeight)||"0",s=k.size(e==null?void 0:e.votes),i=K(t),r=fn(t),c=f.useMemo(()=>wt(Number(mn.fromNano(n))),[n]),a=xt(t);return u(ts,{children:[o(ps,{label:u(gn,{children:[o(Jt,{value:s})," votes"]})}),u(y,{style:{width:"unset"},gap:10,children:[!(r||i)&&u(w,{className:"total",style:{fontWeight:600},children:[c," ",a]}),o(ss,{})]})]})},Xo=()=>{const{proposalAddress:t}=S(),{data:e,dataUpdatedAt:n}=x(t),s=te(e==null?void 0:e.votes,n),i=xt(t),r=K(t);return o(ce,{hideVotingPower:!!r,symbol:i,data:s})},ts=l(y)({flex:1,justifyContent:"space-between",".total":{fontSize:14},"@media (max-width: 600px)":{".total":{fontSize:13}}});function es(){var d;const t=X(),[e,n]=f.useState(pt),s=C(),{proposalAddress:i}=S(),{data:r,isLoading:c}=x(i),a=K(i),p=xt(i),m=()=>{n(h=>h+pt)};return c?o(_,{}):u(us,{title:s.recentVotes,headerComponent:o(Jo,{}),children:[o(Dn,{isLoading:c,isEmpty:!c&&!k.size(r==null?void 0:r.votes),emptyComponent:o(os,{}),children:u(ds,{gap:0,children:[o(Xo,{}),(d=r==null?void 0:r.votes)==null?void 0:d.map((h,g)=>g>=e||h.address===t?null:o(ce,{hideVotingPower:!!a,symbol:p,data:h},h.address))]})}),o(ns,{totalItems:k.size(r==null?void 0:r.votes),amountToShow:e,showMore:m,limit:pt})]})}const ns=l(pn)({marginTop:20,width:"90%",marginLeft:"auto",marginRight:"auto",marginBottom:20}),os=()=>{const t=C();return o(cs,{children:o(w,{children:t.noVotes})})},ss=()=>{var i;const{proposalAddress:t}=S(),{data:e}=x(t),n=io(),s=C();return o(Qo,{data:n,filename:nt((i=e==null?void 0:e.metadata)==null?void 0:i.title),children:o(et,{text:s.downloadCsv,placement:"top",children:o(is,{style:{width:18,height:18}})})})},is=l(hn)(({theme:t})=>({"*":{stroke:t.palette.text.primary}})),ce=({data:t,symbol:e,hideVotingPower:n})=>{const s=X(),i=C();if(!t)return null;const{address:r,votingPower:c,vote:a,hash:p,timestamp:m}=t,d=s===r;return o(rs,{text:`${J.unix(m).utc().fromNow()}`,placement:"top",children:u(ls,{justifyContent:"flex-start",children:[o(as,{address:r,displayText:d?i.you:""}),o(w,{className:"vote",style:{textAlign:n?"right":"center"},children:k.isArray(a)?a.join(", "):a}),!n&&u(w,{className:"voting-power",children:[wt(Number(c))," ",e]})]})})},rs=l(et)({width:"100%"}),as=l(z)({justifyContent:"flex-start",width:160}),cs=l(Ct)({padding:"20px",p:{textAlign:"center",fontSize:17,fontWeight:600}}),ls=l(y)({borderBottom:"0.5px solid rgba(114, 138, 150, 0.16)",padding:"15px 25px",gap:10,".vote":{flex:1,textAlign:"center"},".voting-power":{width:160,textAlign:"right",gap:5,".number-display":{flex:1}},"@media (max-width: 850px)":{alignItems:"flex-start",flexWrap:"wrap",".address":{maxWidth:"60%"},".date":{},".vote":{flex:"unset",marginLeft:"auto"},".voting-power":{width:"100%",textAlign:"left",justifyContent:"flex-start",".number-display ":{flex:"unset",maxWidth:"70%"}}}}),ds=l(A)({}),us=l(U)({".title-container-children":{padding:0}}),ps=l(Yt)({height:28,"*":{fontWeight:600,fontSize:13}}),yt=200,hs=()=>{const{proposalAddress:t}=S(),{isLoading:e}=x(t),n=xn();return e?o(_,{loaderAmount:4}):o(As,{children:n?o(ms,{}):o(fs,{})})};function fs(){return u(A,{alignItems:"flex-start",gap:20,children:[o(le,{}),u(me,{justifyContent:"flex-start",children:[o(ue,{}),o(he,{}),o(fe,{}),o(pe,{url:window.location.href})]}),o(de,{})]})}function ms(){return u(A,{alignItems:"flex-start",gap:20,children:[o(le,{}),u(me,{justifyContent:"flex-start",children:[u(y,{justifyContent:"flex-start",children:[o(ue,{}),o(he,{})]}),u(y,{children:[o(fe,{}),o(pe,{url:window.location.href})]})]}),o(de,{})]})}const le=()=>{var i;const{proposalAddress:t}=S(),e=x(t).data,n=tt.isMockProposal(t)?" (Mock)":"",s=nt((i=e==null?void 0:e.metadata)==null?void 0:i.title);return u(y,{children:[o(bs,{title:`${s}${n}`}),e&&o(gs,{proposal:e})]})},gs=l(yn)({position:"absolute",top:7,right:7}),ys=({onClick:t,showMore:e})=>{const n=C();return o(Es,{open:e?1:0,children:o(xs,{onClick:()=>t(!e),variant:"transparent",children:o(w,{children:e?n.showLess:n.showMore})})})},de=()=>{var d,h;const[t,e]=f.useState(0),n=f.useRef(),{proposalAddress:s}=S(),{data:i}=x(s),[r,c]=f.useState(!1);f.useLayoutEffect(()=>{n.current&&e(n.current.offsetHeight)},[(d=i==null?void 0:i.metadata)==null?void 0:d.description]);const a=nt((h=i==null?void 0:i.metadata)==null?void 0:h.description),p=t>yt,m=t>yt?yt:t;return u(Ss,{children:[o(vs,{ref:n,children:o(zt,{open:0,children:a})}),o(ee,{height:r?"auto":m,duration:0,children:o(zt,{open:r?1:0,children:a})}),p&&o(ys,{showMore:r,onClick:c})]})},Ss=l(Ct)({position:"relative"}),vs=l("span")({position:"absolute",visibility:"hidden",pointerEvents:"none",height:"auto"}),zt=l(bt)(({open:t})=>({img:{display:t?"block":"none"},ul:{paddingLeft:20},ol:{paddingLeft:20}})),bs=l(Sn)({marginBottom:0,marginTop:0}),ue=()=>{const{proposalAddress:t}=S(),{proposalStatusText:e}=vt(t);return o(On,{status:e})},pe=l(vn)({marginLeft:"auto"}),he=()=>{var n;const{daoAddress:t}=S(),e=(n=Et(t).data)==null?void 0:n.daoMetadata;return u(y,{style:{width:"auto"},children:[o(Cs,{src:e==null?void 0:e.metadataArgs.avatar}),o(ws,{to:Zt.daoPage.root(t),className:"dao-name",children:o(Z,{text:nt(e==null?void 0:e.metadataArgs.name)})})]})},fe=()=>{var n;const{daoAddress:t}=S(),e=(n=Et(t).data)==null?void 0:n.daoRoles;return e!=null&&e.proposalOwner?o(z,{displayText:`by ${En(e==null?void 0:e.proposalOwner,5)}`,address:(e==null?void 0:e.proposalOwner)||"",padding:5}):null},ws=l(bn)({display:"flex"}),Cs=l(wn)({minWidth:30,minHeight:30,width:30,height:30,borderRadius:"50%"}),me=l(y)({".dao-name":{p:{fontSize:15,fontWeight:600}},".by":{fontSize:15,fontWeight:600},".address-display-btn":{p:{fontSize:15,fontWeight:600}},"*":{textDecoration:"unset"},[`@media (max-width: ${Gt}px)`]:{flexDirection:"column",alignItems:"flex-start"}}),xs=l(F)(({theme:t})=>({marginLeft:"auto",marginRight:"auto",width:"100%"})),Es=l(Ct)(({open:t,theme:e})=>{const n=e.palette.mode==="light"?"0px -22px 50px 16px #FFFFFF":"0px -22px 50px 16px #222830";return{width:"100%",position:"relative",boxShadow:t===1?"unset":n,background:e.palette.mode==="light"?"white":"#222830",paddingTop:20}}),As=l(Cn)({width:"100%",padding:30,paddingTop:40,position:"relative",[`@media (max-width: ${Gt}px)`]:{padding:20}}),At=15,ge=()=>{const{proposalAddress:t}=S(),e=x(t).isLoading,{proposalStatus:n}=vt(t);return{proposalDescription:o(hs,{}),votes:!n||n===O.NOT_STARTED?null:o(es,{}),vote:!n||n!==O.ACTIVE||e?null:o(Do,{}),deadline:!n||n===O.CLOSED?null:o(Jn,{}),metadata:o(Xn,{}),results:!n||n===O.NOT_STARTED?null:o(go,{})}},Ts=()=>{const{proposalDescription:t,votes:e,vote:n,deadline:s,metadata:i,results:r}=ge();return u(ye,{children:[u(Ps,{children:[t,n,e]}),u(Ns,{children:[s,i,r]})]})},Rs=()=>{const{proposalDescription:t,votes:e,vote:n,deadline:s,metadata:i,results:r}=ge();return u(ye,{children:[s,t,n,r,i,e]})};function Bs(){const t=An("(max-width:800px)"),[e,n]=f.useState(!1),{daoAddress:s,proposalAddress:i}=S(),r=x(i).error,c=Tn(i);f.useEffect(()=>{r&&n(!0)},[r]);const a=c||e,p=tt.isMockProposal(i);return o(Fn,{back:Zt.daoPage.root(s),headerComponent:!p&&o(ks,{}),children:a?o(Rn,{text:"Proposal not found"}):t?o(Rs,{}):o(Ts,{})})}const ks=()=>{const{proposalPage:t}=kn(),{daoAddress:e,proposalAddress:n}=S(),{data:s}=Et(e),i=Vn(),{isLoading:r}=x(n),{isOwner:c,isProposalPublisher:a}=Pn(s==null?void 0:s.daoRoles);return r||!i||!c&&!a?null:o(et,{text:"Edit",children:o(Vs,{onClick:()=>t.edit(e,n),children:o(Nn,{style:{width:20,height:20,color:"white"}})})})},Vs=l(y)({padding:0,width:35,height:35,borderRadius:"50%",background:"#0088CC",cursor:"pointer"}),ye=l(y)({gap:At,alignItems:"flex-start","@media (max-width: 850px)":{flexDirection:"column"}}),Ps=l(A)({width:"calc(100% - 370px - 10px)",gap:At}),Ns=l(A)({width:370,gap:At});export{Bs as ProposalDisplay,Bs as default};
