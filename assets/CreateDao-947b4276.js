import{i as W,aa as N,s as o,C as g,m as I,b as a,f,ar as v,aK as V,aL as z,aM as Q,a3 as F,a4 as C,aN as H,a7 as T,j as c,F as J,a9 as h,ac as Z,l as R,aO as G,aj as K,T as w,a6 as B,aP as U,ax as E,ay as Y,I as q,aA as O,aB as $,aD as D,aH as X,aQ as x,aR as ee,aS as te,n as ae,aT as ne,B as se,aU as oe,ah as re,aV as ie}from"./index-b73c198c.js";import{c as y,u as de,a as le,b as ce,d as ue}from"./dao-form-a908fa1c.js";import{C as pe}from"./index.esm-416d522b.js";import{P as me}from"./Page-03a7dfac.js";const he={name:"",telegram:"",website:"",github:"",about:"",about_en:"",terms:"",avatar:"",hide:!1,nft:"",jetton:"",dns:""},S=W(N(e=>({createDaoSuccessModal:!1,setCreateDaoSuccessModal:t=>e({createDaoSuccessModal:t}),editMode:!1,rolesForm:{},daoMetadataForm:he,step:0,setDaoAddress:t=>e({daoAddress:t}),setStep:t=>e({step:t}),nextStep:()=>e(t=>({step:t.step+1})),prevStep:()=>e(t=>({step:t.step-1})),setEditMode:t=>e({editMode:t}),setDaoMetadataForm:t=>{e({daoMetadataForm:t})},setMetadataAddress:t=>e({metadataAddress:t}),setRolesForm:t=>e({rolesForm:t}),reset:()=>e({daoMetadataForm:{},step:0,rolesForm:{},editMode:!1,metadataAddress:void 0})}),{name:"ton_vote_create_dao"}));function M({children:e}){return I()?a(k,{children:e}):a(k,{children:a(pe,{})})}const k=o(g)({width:"100%",marginTop:50,gap:20,button:{width:"100%"}}),_=e=>{const t=y(),s=de();return[{title:e?t.editSpaceMetadata:t.enterSpaceMetadata,subTitle:t.formInfo,warning:e?t.editWarning:void 0,inputs:s}]},j=(e,t)=>{const s=y(),n=le(e);return[{title:t?s.editStage:s.createSpace,subTitle:s.formInfo,inputs:n}]},Se=()=>{const{rolesForm:e,metadataAddress:t,reset:s}=S(),{addDao:n}=Z(),l=R(),{mutate:p,isLoading:u}=G();return{createDao:()=>p({metadataAddress:t,ownerAddress:e.ownerAddress,proposalOwner:e.proposalOwner,onSuccess:d=>{l.daoPage.root(d),n(d),s()}}),isLoading:u}};function ge(){const{createDao:e,isLoading:t}=Se(),s=y(),n=C(),{daoMetadataForm:l,rolesForm:p}=S(),u=H().data,d=_(),i=j();return a(T,{title:s.createSpace,children:c(f,{children:[a(fe,{children:c(J,{children:[i.map(m=>m.inputs.map(r=>{const b=r.name;return a(A,{input:r,value:p[b]},r.name)})),d.map(m=>m.inputs.map(r=>{const b=r.name;return a(A,{input:r,value:l[b]},r.name)}))]})}),a(M,{children:a(h,{isLoading:t||(u==null?void 0:u.deployAndInitDaoFee)===void 0,onClick:e,children:n.create})})]})})}const fe=o(f)({gap:20}),A=({input:e,value:t})=>{const n=(()=>{if(e.name!=="dev")return e.type==="address"&&K(t)?null:e.type==="checkbox"?a(w,{children:t?"Yes":"No"}):t?e.type==="url"?a(we,{href:t,children:t}):e.type==="image"?a(be,{src:t}):e.type==="address"?a(B,{padding:10,address:t}):e.type==="textarea"?a(Ce,{children:t}):a(w,{children:t}):null})();return n?c(xe,{children:[a(F,{className:"label",children:e.label}),a(ye,{children:n})]}):null},ye=o(v)(({theme:e})=>({borderRadius:10,border:`1px solid ${V(e.palette.mode)}`,width:"100%",padding:10})),be=o(z)({width:45,height:45,borderRadius:"50%",overflow:"hidden"}),we=o(Q)({width:"auto"}),Ce=o(F)({width:"100%"}),xe=o(f)(({theme:e})=>({flexWrap:"wrap",alignItems:"flex-start",justifyContent:"flex-start",gap:5,fontSize:16,color:e.palette.text.primary,".label":{fontSize:14,fontWeight:600}}));function Me(){const{mutate:e,isLoading:t}=U(),s=S(),{daoMetadataForm:n}=s,l=y(),p=_(s.editMode),u=ce(),d=async r=>{const b={about:JSON.stringify({en:r.about_en}),avatar:r.avatar||"",github:r.github||"",hide:r.hide,name:JSON.stringify({en:r.name_en}),terms:"",telegram:r.telegram||"",website:r.website||"",jetton:r.jetton||D,nft:r.nft||D,dns:r.dns||"",dev:r.dev};e({metadata:b,onSuccess:P=>{s.nextStep(),s.setDaoMetadataForm(r),s.setMetadataAddress(P),window.scrollTo(0,0)}})},i=E({initialValues:{name:n.name,telegram:n.telegram,website:n.website,github:n.github,about:n.about,terms:n.terms,avatar:n.avatar,hide:n.hide,jetton:n.jetton,nft:n.nft,dns:n.dns,about_en:n.about_en,name_en:n.name_en,dev:!0},validationSchema:u,validateOnChange:!1,validateOnBlur:!0,onSubmit:d}),m=Y(()=>{s.setDaoMetadataForm(i.values)});return q.useEffect(()=>{m()},[i.values]),a(O,{form:p,formik:i,EndAdornment:ve,children:a(M,{children:a(h,{isLoading:t,onClick:()=>{i.submitForm(),$(i)},children:s.editMode?l.editDetails:l.approveDetails})})})}const ve=({onClick:e})=>{const t=C();return a(Fe,{onClick:e,children:a(w,{children:t.connectedWallet})})},Fe=o(h)({padding:"5px 10px",height:"unset",p:{fontSize:12,display:"inline-block",overflow:"hidden",whiteSpace:"nowrap"}});function De(){const e=y(),{nextStep:t}=S();return a(T,{title:e.gettingStarted,children:c(ke,{children:[a(f,{alignItems:"flex-start",gap:15,children:e.gettingStartedBody.split("/n").map((s,n)=>a(F,{children:s},n))||""}),a(M,{children:a(h,{onClick:t,children:e.start})})]})})}const ke=o(v)({a:{textDecoration:"unset"}});function Ae(){const{setRolesForm:e,rolesForm:t,nextStep:s,editMode:n}=S(),l=ue(),p=j(Ie,n),u=C(),d=E({initialValues:{ownerAddress:t.ownerAddress,proposalOwner:t.proposalOwner},validationSchema:l,validateOnChange:!1,validateOnBlur:!0,onSubmit:i=>{e(i),s()}});return a(O,{form:p,formik:d,children:a(M,{children:a(h,{onClick:()=>{d.submitForm(),$(d)},children:u.next})})})}const Ie=({name:e,formik:t})=>{const s=C(),n=I(),l=()=>{t.setFieldError(e,void 0),t.setFieldValue(e,n)};return!n||t.values[e]===n?null:a(X,{children:a(h,{onClick:l,children:a(w,{children:s.connectedWallet})})})},L=()=>{const e=y();return[{title:e.gettingStarted,component:De},{title:e.spaceMetadata,component:Me},{title:e.stage,component:Ae},{title:e.createSpace,component:ge}]};function Te(){const{step:e,setStep:t,setEditMode:s}=S(),n=C(),l=L(),p=ae(),u=d=>{d<e&&t(d)};return a(je,{children:c(Oe,{children:[a(Be,{}),l.map((d,i)=>{const m=e>i,r=e===i;return c(_e,{children:[c($e,{onClick:()=>u(i),style:{background:m?p.palette.primary.main:p.palette.background.paper,cursor:m?"pointer":"unset"},children:[m&&a(ne,{style:{color:"white"}}),r&&a(Ee,{})]}),a("div",{style:{flex:1},children:a(se,{text:d.title})}),i>0&&m&&a(Re,{onClick:()=>{t(i),s(!0)},children:n.edit})]},i)})]})})}const Re=o(h)({padding:"5px 10px",height:"unset","*":{fontSize:14}}),Be=o("figure")(({theme:e})=>({width:1,height:"100%",top:"50%",left:20,transform:"translate(0, -50%)",background:e.palette.primary.main,position:"absolute",margin:0,[`@media (max-width: ${x}px)`]:{left:15}})),Ee=o(ee)(({theme:e})=>({background:e.palette.primary.main,width:"20%",height:"20%",borderRadius:"50%",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"})),Oe=o(f)({gap:30,position:"relative",[`@media (max-width: ${x}px)`]:{gap:15}}),$e=o(g)(({theme:e})=>({position:"relative",width:40,height:40,borderRadius:"50%",border:`2px solid ${e.palette.primary.main}`,[`@media (max-width: ${x}px)`]:{width:30,height:30}})),_e=o(g)({gap:20,justifyContent:"flex-start",position:"relative"}),je=o(te)({});function Le(){const{daoAddress:e,createDaoSuccessModal:t,setCreateDaoSuccessModal:s}=S(),{daoPage:n}=R();return a(Ne,{onClose:()=>{},open:t,children:c(ze,{gap:30,children:[c(g,{gap:20,children:[a(We,{children:"Dao created successfully"}),a(Pe,{})]}),a(B,{address:e}),c(Ve,{children:[a(h,{onClick:()=>s(!0),children:"Close"}),a(h,{onClick:()=>{n.root(e),s(!1)},children:"View Dao"})]})]})})}const Pe=o(oe)(({theme:e})=>({color:e.palette.primary.main,width:30,height:30})),We=o(w)({fontSize:22,fontWeight:600}),Ne=o(re)({maxWidth:500}),Ve=o(g)({button:{width:"40%"}}),ze=o(f)({}),Qe=()=>{const e=L(),t=S(n=>n.step),s=e[t].component;return c(He,{children:[a(s,{}),a(Le,{})]})};function Ye(){return a(me,{back:ie.spaces,children:c(Je,{children:[a(Te,{}),a(Qe,{})]})})}const He=o(v)({flex:1,[`@media (max-width: ${x}px)`]:{width:"100%"}}),Je=o(g)({gap:20,alignItems:"flex-start",width:"100%",[`@media (max-width: ${x}px)`]:{flexDirection:"column"}});export{Ye as CreateDao,Ye as default};
